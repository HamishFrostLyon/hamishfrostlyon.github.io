<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />

  <!-- Primary Meta Tags -->
  <title>
    {% if page.title %}{{ page.title }}{% if page.layout == "post" %} - {{
    site.title }}{% endif %}{% else %}{{ site.title }} - {{ site.tagline }}{%
    endif %}
  </title>
  <meta
    name="title"
    content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}"
  />
  <meta
    name="description"
    content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip | truncate: 160 }}{% else %}{{ site.description }}{% endif %}"
  />
  <meta name="author" content="{{ site.author.name | default: site.title }}" />
  <meta
    name="keywords"
    content="{% if page.tags %}{{ page.tags | join: ', ' }}{% else %}{{ site.keywords | join: ', ' }}{% endif %}"
  />

  <!-- Open Graph / Facebook / LinkedIn -->
  <meta
    property="og:type"
    content="{% if page.layout == 'post' %}article{% else %}website{% endif %}"
  />
  <meta property="og:locale" content="{{ site.locale | default: 'en_AU' }}" />
  <meta property="og:site_name" content="{{ site.title }}" />
  <meta property="og:url" content="{{ page.url | absolute_url }}" />
  <meta
    property="og:title"
    content="{% if page.title %}{{ page.title }}{% else %}{{ site.title }}{% endif %}"
  />
  <meta
    property="og:description"
    content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip | truncate: 160 }}{% else %}{{ site.description }}{% endif %}"
  />
  {% if page.image %}
  <meta property="og:image" content="{{ page.image | absolute_url }}" />
  <meta
    property="og:image:alt"
    content="{{ page.image_alt | default: page.title }}"
  />
  {% elsif site.og_image %}
  <meta property="og:image" content="{{ site.og_image | absolute_url }}" />
  {% endif %}

  <!-- LinkedIn specific -->
  <meta property="og:author" content="{{ site.author.name }}" />
  <meta name="author" content="{{ site.author.name }}" />

  <!-- Article specific meta -->
  {% if page.layout == "post" %}
  <meta
    property="article:author"
    content="{{ site.author.name | default: site.title }}"
  />
  <meta
    property="article:published_time"
    content="{{ page.date | date_to_xmlschema }}"
  />
  {% if page.last_modified_at %}
  <meta
    property="article:modified_time"
    content="{{ page.last_modified_at | date_to_xmlschema }}"
  />
  {% endif %} {% for tag in page.tags %}
  <meta property="article:tag" content="{{ tag }}" />
  {% endfor %} {% endif %}

  <!-- Canonical URL -->
  <link
    rel="canonical"
    href="{{ page.url | replace:'index.html','' | absolute_url }}"
  />
  {% include hreflang.html %}

  <!-- RSS Feed -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="{{ site.title }} RSS Feed"
    href="{{ '/feed.xml' | absolute_url }}"
  />
  <link
    rel="alternate"
    type="application/json"
    title="{{ site.title }} JSON Feed"
    href="{{ '/feed.json' | absolute_url }}"
  />

  <!-- Favicon -->
  <link
    rel="icon"
    type="image/png"
    sizes="32x32"
    href="{{ '/favicon-32x32.png' | relative_url }}"
  />
  <link
    rel="icon"
    type="image/png"
    sizes="16x16"
    href="{{ '/favicon-16x16.png' | relative_url }}"
  />
  <link
    rel="apple-touch-icon"
    sizes="180x180"
    href="{{ '/apple-touch-icon.png' | relative_url }}"
  />
  <link rel="manifest" href="{{ '/site.webmanifest' | relative_url }}" />
  <meta name="theme-color" content="#ffffff" />

  <!-- Security -->
  <meta
    http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self';"
  />

  <!-- CSS with font loading optimization -->
  <link
    rel="preload"
    as="style"
    href="{{ '/assets/css/main.css' | relative_url }}"
  />
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}" />

  <!-- Font loading strategy -->
  <style>
    /* Critical font-face declarations */
    @font-face {
      font-family: system-ui;
      font-style: normal;
      font-weight: 300 900;
      font-display: swap;
      src:
        local('system-ui'), local('-apple-system'), local('BlinkMacSystemFont'),
        local('Segoe UI'), local('Roboto');
    }
  </style>

  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
  <link rel="dns-prefetch" href="https://fonts.googleapis.com" />

  <!-- robots -->
  {% if page.robots %}
  <meta name="robots" content="{{ page.robots }}" />
  {% endif %}

  <!-- Verification tags -->
  {% if site.google_site_verification %}
  <meta
    name="google-site-verification"
    content="{{ site.google_site_verification }}"
  />
  {% endif %} {% if site.bing_site_verification %}
  <meta name="msvalidate.01" content="{{ site.bing_site_verification }}" />
  {% endif %} {% include structured-data.html %}

  <!-- Mathematical notation support -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'],
          ['\\(', '\\)'],
        ],
        displayMath: [
          ['$$', '$$'],
          ['\\[', '\\]'],
        ],
        processEscapes: true,
        processEnvironments: true,
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      },
    };
  </script>
  <script
    type="text/javascript"
    id="MathJax-script"
    async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
  ></script>
</head>
